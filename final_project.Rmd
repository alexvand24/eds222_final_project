---
title: "Final Project"
subtitle: "EDS 222"
author: "Alex Vand"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```


```{r}
# install packages
library(tidyverse)
library(tsibble)
library(zoo)
library(feasts)
library(janitor)
library(dplyr)
```

## Question

## Background & Motivation

## Data


- https://www.cpc.ncep.noaa.gov/data/indices/

NOAA's National Weather Service Climate Prediction Center monthly atmospheric and sea surface temperature indices from January 1982 to October 2021. Measurements of SST anomalies across four regions of the pacific are used to examine El Ni√±o Southern Oscillation for 40? year old data.

- https://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices

```{r}
# read in the raw data (.csv from NOAA)
data_raw_enso <- read_csv(here::here("enso_data_raw_1982.csv"))

data_enso <- janitor::clean_names(data_raw_enso)
```
## Analysis and Results

### Lag Analysis

Statistical lag analysis is implemented through the autocorrelation function `acf`, where the argument `lax.max = ` is indicated/specified in each of the following scenarios:
- 478

$t-125$

$t-175$

$t-390$

```{r}
acf4 <- acf(x = data_enso$anom_4, lag.max = 478,
            main = "Autocorrelation function")
```



```{r}
acf6 <- acf(x = data_enso$anom_6, lag.max = 478)
```


```{r}
acf6 <- acf(x = data_enso$anom_6, lag.max = 288)
```


```{r}
acf8 <- acf(x = data_enso$anom_8, lag.max = 478)
```



```{r}
acf10 <- acf(x = data_enso$anom_10, lag.max = 478)
```



```{r}
acf10 <- acf(x = data_enso$anom_10, lag.max = 200)
```



```{r}
max(acf10$lag[acf10=0.2])

sort(acf10$lag[acf10=-0.3])
```


### Classical Decomposition

```{r}
data_enso <- data_raw_enso %>% 
  mutate(month = case_when(
    MON <= 9 ~ paste0(0, MON),
    MON > 9 ~ paste0(MON))) %>%
  unite(col = date, YR, month, sep = "-") %>% 
  mutate(date = yearmonth(as.yearmon(date, format = '%Y-%m'))) %>%
  na.omit() %>%
  mutate(ANOM10 = ANOM...10) %>% 
  select(date, ANOM10) %>% 
  as_tsibble(index = date)
```

```{r}
data_enso %>%
  model(classical_decomposition(ANOM10, type = "additive")) %>%
  components() %>%
  autoplot() +
  labs(title = "Classical additive decomposition of ENSO SST anomalies")
```


```{r}
# repeated code chunk - DELETE LATER
data_raw_enso <- read_csv(here::here("enso_data_raw_1982.csv"))

data_enso <- janitor::clean_names(data_raw_enso)
```

```{r}
data_enso <- data_enso %>% 
  mutate(month = case_when(
    mon <= 9 ~ paste0(0, mon),
    mon > 9 ~ paste0(mon))) %>%
  unite(col = date, yr, mon, sep = "-") %>% 
  mutate(date = yearmonth(as.yearmon(date, format = '%Y-%m'))) %>%
  na.omit() %>%
  select(date, anom_6) %>% 
  as_tsibble(index = date)
```

```{r}
data_enso %>%
  model(classical_decomposition(anom_6, type = "additive")) %>%
  components() %>%
  autoplot() +
  labs(title = "Classical additive decomposition of ENSO SST anomalies")
```

https://tsibble.tidyverts.org/reference/as-tsibble.html


## Future Research
Future research aims to hopes to 



